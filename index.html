<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Karting Telemetry Sessions</title>
  <link rel="stylesheet" href="css/common.css">
  <link rel="stylesheet" href="css/index.css">
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>ğŸï¸ Karting Telemetry</h1>
      <div class="subtitle">Track your performance across all sessions</div>
    </div>

    <div class="stats-summary" id="summary-stats">
      <div class="stat-card">
        <div class="stat-label">Total Sessions</div>
        <div class="filtered-stat-value" id="filtered-sessions-count">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Total Laps</div>
        <div class="filtered-stat-value" id="filtered-total-laps">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Best Lap Ever</div>
        <div class="filtered-stat-value" id="filtered-best-lap">-</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Tracks Driven</div>
        <div class="filtered-stat-value" id="filtered-tracks-count">-</div>
      </div>
    </div>

    <div class="controls">
      <input type="text" id="search-input" class="search-box" placeholder="Search driver, track, or kart...">

      <div class="filter-group">
        <select id="track-filter" class="select-filter">
          <option value="">All Tracks</option>
        </select>
        <select id="config-filter" class="select-filter">
          <option value="">All Configurations</option>
        </select>
        <select id="date-filter" class="select-filter">
          <option value="all">All Dates</option>
          <option value="today">Today</option>
          <option value="week">Last 7 Days</option>
          <option value="month">Last 30 Days</option>
          <option value="custom">Custom Range</option>
        </select>
      </div>

      <div class="date-filter-group" id="custom-date-range" style="display: none;">
        <div class="date-range">
          <span>From:</span>
          <input type="date" id="date-from" class="date-input">
        </div>
        <div class="date-range">
          <span>To:</span>
          <input type="date" id="date-to" class="date-input">
        </div>
      </div>

      <div class="filter-group">
        <button class="filter-btn active" data-sort="date">ğŸ“… Newest</button>
        <button class="filter-btn" data-sort="fastest">âš¡ Fastest</button>
        <button id="reset-filters" class="reset-btn">ğŸ”„ Reset</button>
      </div>
    </div>

    <div id="sessions-container">
      <div id="skeleton-loader"></div>
    </div>
  </div>

  <button class="info-button" id="info-button" title="Show Legend & Info">â„¹ï¸</button>

  <div class="legend-overlay" id="legend-overlay">
    <div class="legend-content">
      <div class="legend-header">
        <div class="legend-title">Legend & Information</div>
        <button class="close-legend" id="close-legend" title="Close">âœ•</button>
      </div>

      <div class="legend-section">
        <div class="legend-section-title">ğŸ… Badges</div>
        <div class="legend-item">
          <div class="legend-icon">
            <span class="badge pb-badge">â­ PB</span>
          </div>
          <div class="legend-text">
            <div class="legend-text-title">Personal Best</div>
            <div class="legend-text-desc">Indicates your fastest lap time for a specific driver on a specific track
              configuration.</div>
          </div>
        </div>

        <div class="legend-item">
          <div class="legend-icon">
            <span class="badge track-pb-badge">ğŸ¯ Track PB</span>
          </div>
          <div class="legend-text">
            <div class="legend-text-title">Track Record</div>
            <div class="legend-text-desc">The fastest lap time recorded across ALL drivers on a specific track
              configuration.</div>
          </div>
        </div>
      </div>

      <div class="legend-section">
        <div class="legend-section-title">ğŸ“Š Trends</div>
        <div class="legend-item">
          <div class="legend-icon">
            <span class="trend-indicator trend-improving">ğŸ“ˆ 2.5% faster</span>
          </div>
          <div class="legend-text">
            <div class="legend-text-title">Improving Performance</div>
            <div class="legend-text-desc">Your lap times are improving compared to your recent history (last 3 sessions
              on this track).
              Shows percentage of improvement.</div>
          </div>
        </div>

        <div class="legend-item">
          <div class="legend-icon">
            <span class="trend-indicator trend-declining">ğŸ“‰ 1.8% slower</span>
          </div>
          <div class="legend-text">
            <div class="legend-text-title">Declining Performance</div>
            <div class="legend-text-desc">Your lap times are slower than recent sessions. This indicates a performance
              decline of more than 1% compared to your last 3 sessions on this track.</div>
          </div>
        </div>

        <div class="legend-item">
          <div class="legend-icon">
            <span class="trend-indicator trend-stable">â¡ï¸ Stable</span>
          </div>
          <div class="legend-text">
            <div class="legend-text-title">Consistent Performance</div>
            <div class="legend-text-desc">Your lap times are consistent with recent sessions (within Â±1%). This shows
              you're maintaining a steady performance level.</div>
          </div>
        </div>
      </div>

      <div class="legend-section">
        <div class="legend-section-title">â„¹ï¸ Performance Optimizations</div>
        <div class="legend-item">
          <div class="legend-text">
            <div class="legend-text-desc">
              This system is optimized to handle 1000+ sessions efficiently with pagination (50 sessions per page),
              optimized trend calculations using Map-based indexing, and lazy data processing.
              Filtering and sorting operations are performed in memory for instant results.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="js/index.js"></script>
</body>

</html>